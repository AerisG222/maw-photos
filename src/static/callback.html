<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Callback</title>
    <link rel="icon" type="image/x-icon" href="favicon.png">
    <script src="oidc-client.min.js" type="application/javascript"></script>
</head>

<body>
    <script>
        var Oidc = window.Oidc;
        var usrMgr = new Oidc.UserManager({ response_mode: 'query' });
        var isPopupCallback = JSON.parse(window.localStorage.getItem('ngoidc:isPopupCallback'));

        if (isPopupCallback) {
            usrMgr.signinPopupCallback();
        } else {
            usrMgr.signinRedirectCallback().then(user => {
                if(!!user.state && !!user.state.redirect_url) {
                    window.location.href = user.state.redirect_url;
                } else {
                    window.location.href = '/';
                }
            });
        }
    </script>
</body>

</html>
